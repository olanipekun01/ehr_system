<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nurse Reports</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .healthcare-heading { font-size: 1.25rem; font-weight: 600; }
        .healthcare-input { @apply border-gray-300 focus:ring-blue-500 focus:border-blue-500; }
        .healthcare-form { border-color: #e5e7eb; }
        .bg-primary { background-color: #3b82f6; }
        .hover:bg-primary-dark { background-color: #2563eb; }
        .bg-primary-light { background-color: #dbeafe; }
        .bg-secondary { background-color: #9333ea; }
        .bg-secondary-accent { color: #9333ea; }
        .bg-accent { background-color: #8b5cf6; }
        .bg-accent-light { background-color: #ede9fe; }
        .bg-success { background-color: #22c55e; }
        .bg-success-light { background-color: #bbf7d0; }
        .bg-warning { background-color: #f59e0b; }
        .bg-warning-light { background-color: #fef3c7; }
        .text-muted-foreground { color: #6b7280; }
        .bg-muted\/50 { background-color: #e5e7eb80; }
    </style>
</head>
<body class="min-h-screen bg-gray-100 p-6">
    <div class="max-w-6xl mx-auto space-y-6" id="app">
        <!-- Header -->
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Nurse Reports</h1>
                <p class="text-gray-600">Submit daily activity reports and view previous submissions</p>
            </div>
        </div>

        <!-- Submit New Report -->
        <div class="bg-white rounded-lg shadow healthcare-form">
            <div class="p-6 border-b">
                <h2 class="flex items-center gap-2 healthcare-heading">
                    <svg class="h-5 w-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Submit Daily Activity Report
                </h2>
            </div>
            <div class="p-6">
                <form id="reportForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="shiftDate" class="block text-sm font-medium text-gray-700">Shift Date *</label>
                            <input id="shiftDate" type="date" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="nurseName" class="block text-sm font-medium text-gray-700">Nurse Name *</label>
                            <input id="nurseName" placeholder="Enter your full name" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>

                    <div>
                        <label for="summary" class="block text-sm font-medium text-gray-700">Summary of Activities *</label>
                        <textarea id="summary" rows="6" placeholder="Describe your shift activities, patient care provided, procedures performed, etc." required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    </div>

                    <div>
                        <label for="incidents" class="block text-sm font-medium text-gray-700">Notes on Incidents/Observations</label>
                        <textarea id="incidents" rows="4" placeholder="Record any incidents, unusual observations, safety concerns, or noteworthy events (optional)" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    </div>

                    <div class="flex justify-end">
                        <button id="submitButton" type="submit" class="px-8 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50">
                            Submit Report
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Reports Overview -->
        <div class="bg-white rounded-lg shadow">
            <div class="p-6 border-b">
                <h2 class="flex items-center gap-2 healthcare-heading">
                    <svg class="h-5 w-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V7a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    Reports Overview
                </h2>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-blue-100 p-4 rounded-lg text-center">
                        <h3 id="totalReports" class="text-2xl font-bold text-blue-600">0</h3>
                        <p class="text-sm text-gray-500">Total Reports</p>
                    </div>
                    <div class="bg-green-100 p-4 rounded-lg text-center">
                        <h3 id="reportingDays" class="text-2xl font-bold text-green-600">0</h3>
                        <p class="text-sm text-gray-500">Reporting Days</p>
                    </div>
                    <div class="bg-yellow-100 p-4 rounded-lg text-center">
                        <h3 id="reportsWithIncidents" class="text-2xl font-bold text-yellow-600">0</h3>
                        <p class="text-sm text-gray-500">Reports with Incidents</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports List -->
        <div class="bg-white rounded-lg shadow">
            <div class="p-6 border-b">
                <h2 class="flex items-center gap-2 healthcare-heading">
                    <svg class="h-5 w-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    Previous Reports
                </h2>
            </div>
            <div class="p-6" id="reportsContainer">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <!-- Guidelines -->
        <div class="bg-white rounded-lg shadow">
            <div class="p-6 border-b">
                <h2 class="healthcare-heading">Reporting Guidelines</h2>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm">
                    <div>
                        <h4 class="font-medium text-blue-600 mb-2">What to Include in Activity Summary:</h4>
                        <ul class="space-y-1 text-gray-500">
                            <li>• Number of patients attended to</li>
                            <li>• Medications administered</li>
                            <li>• Procedures performed</li>
                            <li>• Vital signs monitoring</li>
                            <li>• Patient education provided</li>
                            <li>• Shift handover information</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-medium text-yellow-600 mb-2">Incident Reporting:</h4>
                        <ul class="space-y-1 text-gray-500">
                            <li>• Medical emergencies</li>
                            <li>• Equipment malfunctions</li>
                            <li>• Patient safety concerns</li>
                            <li>• Medication errors or near misses</li>
                            <li>• Unusual patient behaviors</li>
                            <li>• Infection control issues</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Mock types and utilities
            const NurseReport = {
                id: String,
                shiftDate: String,
                nurseName: String,
                summary: String,
                incidents: String,
                createdAt: String
            };

            function generateId() {
                return 'xxxx-xxxx-xxx'.replace(/x/g, () => (Math.random() * 16 | 0).toString(16));
            }

            function formatDateTime(timestamp) {
                return new Date(timestamp).toLocaleString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }

            // Mock storage
            const reportStorage = {
                getAll: () => {
                    const stored = localStorage.getItem('reports');
                    return stored ? JSON.parse(stored) : [];
                },
                save: (report) => {
                    const allReports = reportStorage.getAll();
                    allReports.push(report);
                    localStorage.setItem('reports', JSON.stringify(allReports));
                }
            };

            // State
            let reports = [];
            let isSubmitting = false;
            let reportForm = {
                shiftDate: new Date().toISOString().split('T')[0],
                nurseName: "",
                summary: "",
                incidents: ""
            };

            // DOM elements
            const shiftDate = document.getElementById('shiftDate');
            const nurseName = document.getElementById('nurseName');
            const summary = document.getElementById('summary');
            const incidents = document.getElementById('incidents');
            const submitButton = document.getElementById('submitButton');
            const reportFormElement = document.getElementById('reportForm');
            const totalReports = document.getElementById('totalReports');
            const reportingDays = document.getElementById('reportingDays');
            const reportsWithIncidents = document.getElementById('reportsWithIncidents');
            const reportsContainer = document.getElementById('reportsContainer');

            // Load reports
            function loadReports() {
                const allReports = reportStorage.getAll();
                allReports.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());
                reports = allReports;
                populateReports();
                updateOverview();
            }

            // Update state from inputs
            shiftDate.addEventListener('change', (e) => { reportForm.shiftDate = e.target.value; });
            nurseName.addEventListener('input', (e) => { reportForm.nurseName = e.target.value; });
            summary.addEventListener('input', (e) => { reportForm.summary = e.target.value; });
            incidents.addEventListener('input', (e) => { reportForm.incidents = e.target.value; });

            // Populate reports
            function populateReports() {
                if (reports.length > 0) {
                    const reportsByDate = {};
                    reports.forEach(report => {
                        if (!reportsByDate[report.shiftDate]) {
                            reportsByDate[report.shiftDate] = [];
                        }
                        reportsByDate[report.shiftDate].push(report);
                    });
                    const uniqueDates = Object.keys(reportsByDate).sort((a, b) => new Date(b).getTime() - new Date(a).getTime());
                    reportsContainer.innerHTML = uniqueDates.map(date => `
                        <div class="border rounded-lg p-4 mb-4">
                            <h3 class="font-semibold text-lg mb-4 flex items-center gap-2">
                                <svg class="h-5 w-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                                ${new Date(date).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                                <span class="text-sm text-gray-500 ml-2">(${reportsByDate[date].length} report${reportsByDate[date].length !== 1 ? 's' : ''})</span>
                            </h3>
                            ${reportsByDate[date].map(report => `
                                <div key="${report.id}" class="bg-gray-100/50 rounded-lg p-4 mb-4 space-y-3">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-2">
                                            <svg class="h-4 w-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                            </svg>
                                            <span class="font-medium">${report.nurseName}</span>
                                        </div>
                                        <div class="flex items-center gap-2 text-sm text-gray-500">
                                            <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                            Submitted ${formatDateTime(report.createdAt)}
                                        </div>
                                    </div>
                                    <div>
                                        <label class="font-medium text-purple-600">Activity Summary</label>
                                        <p class="text-sm mt-1 leading-relaxed">${report.summary}</p>
                                    </div>
                                    ${report.incidents ? `
                                        <div>
                                            <label class="font-medium text-yellow-600 flex items-center gap-2">
                                                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4.843a1.875 1.875 0 00-3.464 0L3.133 19c-.77 1.333.192 3 1.732 3z" />
                                                </svg>
                                                Incidents & Observations
                                            </label>
                                            <p class="text-sm mt-1 leading-relaxed bg-yellow-100 p-2 rounded">${report.incidents}</p>
                                        </div>
                                    ` : ''}
                                    <div class="flex items-center justify-between pt-2 border-t border-gray-200">
                                        <div class="flex items-center gap-2 text-sm text-green-600">
                                            <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                            Report Completed
                                        </div>
                                        <span class="text-xs text-gray-500">Report ID: ${report.id}</span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `).join('');
                } else {
                    reportsContainer.innerHTML = `
                        <div class="text-center py-12">
                            <svg class="h-12 w-12 mx-auto mb-4 text-gray-500 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V7a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <h3 class="text-lg font-medium mb-2">No Reports Yet</h3>
                            <p class="text-gray-500">Submit your first daily activity report using the form above.</p>
                        </div>
                    `;
                }
            }

            // Update overview stats
            function updateOverview() {
                totalReports.textContent = reports.length;
                const uniqueDates = [...new Set(reports.map(r => r.shiftDate))];
                reportingDays.textContent = uniqueDates.length;
                reportsWithIncidents.textContent = reports.filter(r => r.incidents.trim()).length;
            }

            // Handle form submission
            reportFormElement.addEventListener('submit', (e) => {
                e.preventDefault();
                isSubmitting = true;
                submitButton.textContent = 'Submitting...';
                submitButton.disabled = true;

                try {
                    if (!reportForm.nurseName.trim()) {
                        throw new Error("Nurse name is required");
                    }
                    if (!reportForm.summary.trim()) {
                        throw new Error("Activity summary is required");
                    }

                    const report = {
                        id: generateId(),
                        shiftDate: reportForm.shiftDate,
                        nurseName: reportForm.nurseName.trim(),
                        summary: reportForm.summary.trim(),
                        incidents: reportForm.incidents.trim(),
                        createdAt: new Date().toISOString()
                    };

                    reportStorage.save(report);
                    loadReports();

                    alert("Report Submitted\nYour daily activity report has been saved successfully.");

                    reportForm = {
                        shiftDate: new Date().toISOString().split('T')[0],
                        nurseName: "",
                        summary: "",
                        incidents: ""
                    };
                    shiftDate.value = reportForm.shiftDate;
                    nurseName.value = reportForm.nurseName;
                    summary.value = reportForm.summary;
                    incidents.value = reportForm.incidents;
                } catch (error) {
                    alert(`Submission Failed\n${error instanceof Error ? error.message : 'Failed to submit report'}`);
                } finally {
                    isSubmitting = false;
                    submitButton.textContent = 'Submit Report';
                    submitButton.disabled = false;
                }
            });

            // Initialize
            loadReports();
        });
    </script>
</body>
</html>